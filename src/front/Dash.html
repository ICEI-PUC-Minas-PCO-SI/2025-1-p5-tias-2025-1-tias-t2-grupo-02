<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Casa de Repouso - Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
    <style>
        :root {
            --bege-claro: #E6D2B6;
            --cinza-claro: #BEBEBE;
            --preto-suave: #2B2B2B;
            --branco-suave: #F5F3EF;
            --cinza-medio: #9C9C9C;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background-color: var(--branco-suave);
            color: var(--preto-suave);
        }

        main {
            flex-grow: 1;
        }

       
        .container {
            max-width: 1200px;
            margin: 0 auto; /* centraliza o container */
            padding: 0 20px; 
            width: 100%; /* garante que ocupe 100% da largura disponível até o max-width */
        }

        header {
            background-color: var(--bege-claro); 
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .navbar {
            background-color: #e4cfb6; 
            padding: 0; 
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar-left {
            display: flex;
            align-items: center;
            font-size: 1.2rem;
            font-weight: bold;
            height: 80px; 
            background-color: var(--bege-claro); 
            padding: 0 20px;
        }

        .logo {
            height: 60px;
            margin-right: 15px; 
            margin-left: 10px; 
        }

        .navbar-right ul {
            list-style: none;
            display: flex;
            gap: 25px;
            margin: 0;
            padding: 0 20px;
        }

        .navbar-right a {
            text-decoration: none;
            color: #000;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .navbar-right a:hover {
            color: var(--branco-suave);
            text-decoration: underline;
        }

        .dashboard-content {
            padding: 2rem 0; 
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .period-selector {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* --- animações adicionadas para o select do período e correção do bug --- */
        .period-selector select {
            border: 1px solid var(--cinza-medio);
            border-radius: 4px;
           
            padding: 8px 30px 8px 12px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease; /* transição para foco */
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13%205.7L146.2%20202.7%2018.7%2075.1a17.6%2017.6%200%200%200-25.3%2023.2l130.8%20130.8c6.7%206.7%2017.4%206.7%2024.1%200l130.8-130.8c6.7-6.5%206.7-17.3%200-24z%22%2F%3E%3C%2Fsvg%3E'); /* ícone de seta customizado */
            background-repeat: no-repeat;
            background-position: right 10px center; 
            background-size: 12px;
            cursor: pointer;
        }

        .period-selector select:focus {
            outline: none;
            border-color: var(--bege-claro);
            box-shadow: 0 0 0 3px rgba(230, 210, 182, 0.5); /* sombra bege suave */
        }

        .kpi-cards {
            display: flex;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .kpi-card {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 1rem;
            flex: 1;
            min-width: 200px;
            /* --- animações adicionadas para os kpis --- */
            transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
        }

        .kpi-card:hover {
            transform: translateY(-5px); 
            box-shadow: 0 4px 15px rgba(0,0,0,0.15); 
        }

        .kpi-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .kpi-value {
            font-size: 2rem;
            margin: 10px 0;
        }

        .kpi-footer {
            font-size: 0.9rem;
            color: #666;
        }

        .charts-section {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .chart-container {
            flex: 1;
            background: #fff;
            padding: 1rem;
            border-radius: 8px;
            min-width: 300px;
        }

        .icon {
            font-size: 1.5rem;
        }

        .icon.blue { color: #2196f3; }
        .icon.green { color: #4caf50; }
        .icon.orange { color: #ff9800; }

        canvas {
            max-width: 100%;
            height: 200px !important;
        }

        footer {
            background-color: var(--preto-suave);
            color: var(--branco-suave);
            padding: 15px 20px; 
            text-align: center;
        }
        .footer-content {
            max-width: 1200px; 
            margin: 0 auto;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            padding-bottom: 5px; 
        }

        .footer-logo {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .footer-logo-img {
            width: 40px;
            height: 40px;
            margin-right: 10px; 
            filter: brightness(0) invert(1);
        }

        .footer-logo-text {
            font-size: 18px;
            font-weight: 500;
        }

        .footer-links {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }

        .footer-column {
            min-width: 200px;
            text-align: left;
        }

        .footer-column-title {
            font-size: 16px; 
            margin-bottom: 8px;
            color: var(--bege-claro);
        }

        .footer-column ul {
            list-style: none;
            padding: 0;
        }

        .footer-link {
            display: block;
            margin-bottom: 3px; 
            color: var(--branco-suave);
            text-decoration: none;
            font-size: 13px; 
            /* --- animações adicionadas para os links do rodapé --- */
            transition: color 0.3s ease;
        }

        .footer-link:hover {
            color: var(--bege-claro);
        }

        .footer-bottom {
            padding-top: 8px; 
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            width: 100%;
            font-size: 12px; 
            color: var(--cinza-claro);
        }

        @media (max-width: 768px) {
            .footer-content {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .footer-links {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }

            .footer-column {
                text-align: center;
            }

            .navbar-left {
                height: auto;
                padding: 10px 15px; /* ajusta o padding para telas menores */
                font-size: 1rem;
            }

            .logo {
                height: 40px; /* logo menor em telas pequenas */
                margin-right: 10px;
            }

            .navbar-right ul {
                flex-direction: column; 
                align-items: center;
                gap: 10px;
                padding: 10px 0; 
                width: 100%; 
            }

            .navbar {
                flex-direction: column; 
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="navbar container">
            <div class="navbar-left">
                <img src="logo.png" alt="Logo" class="logo"/>
                <span>CASA DE REPOUSO DO JEITINHO DA VOVÓ</span>
            </div>
            <nav class="navbar-right">
                <ul>
                    <li><a href="Dash.html">Início</a></li>
                    <li><a href="pesquisa_paciente.html">Pacientes</a></li>
                    <li><a href="gerenciamento.html">Medicamentos</a></li>
                    <li><a href="relatorio.HTML">Relatórios</a></li>
                    <li><a href="help_page_final.html">Ajuda</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container dashboard-content">
            <div class="dashboard-header">
                <div>
                    <h2>Dashboard</h2>
                    <p>Visão geral do asilo e indicadores principais</p>
                </div>
                <div class="period-selector">
                    <label for="periodSelect">Período:</label>
                    <select id="periodSelect">
                        <option value="semana">Esta semana</option>
                        <option value="mes">Este mês</option>
                    </select>
                </div>
            </div>

            <div class="kpi-cards">
                <div class="kpi-card">
                    <div class="kpi-header">
                        <h3>Total de Pacientes</h3>
                        <i class="fas fa-user-friends icon blue"></i>
                    </div>
                    <div class="kpi-value" id="totalPacientes">--</div>
                    <div class="kpi-footer" id="novosPacientes">--</div>
                </div>

                <div class="kpi-card">
                    <div class="kpi-header">
                        <h3>Medicamentos Administrados</h3>
                        <i class="fas fa-pills icon green"></i>
                    </div>
                    <div class="kpi-value" id="medicamentos">--</div>
                    <div class="kpi-footer" id="mudancaMedicamentos">--</div>
                </div>

                <div class="kpi-card">
                    <div class="kpi-header">
                        <h3>Atividades Realizadas</h3>
                        <i class="fas fa-clipboard-list icon orange"></i>
                    </div>
                    <div class="kpi-value" id="atividades">--</div>
                    <div class="kpi-footer" id="mudancaAtividades">--</div>
                </div>
            </div>

            <div class="charts-section">
                <div class="chart-container">
                    <h3>Ocupação por Mês</h3>
                    <canvas id="ocupacaoChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Status de Estoque</h3>
                    <canvas id="estoqueChart"></canvas>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="logo.png" alt="Logo" class="footer-logo-img"/>
                <span class="footer-logo-text">CASA DE REPOUSO DO JEITINHO DA VOVÓ</span>
            </div>
            <div class="footer-links">
                <div class="footer-column">
                    <h4 class="footer-column-title">Sistema</h4>
                    <ul>
                        <li><a href="Dash.html" class="footer-link">Início</a></li>
                        <li><a href="pesquisa_paciente.html" class="footer-link">Pacientes</a></li>
                        <li><a href="gerenciamento.html" class="footer-link">Medicamentos</a></li>
                        <li><a href="relatorio.HTML" class="footer-link">Relatórios</a></li>
                        <li><a href="help_page_final.html" class="footer-link">Ajuda</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4 class="footer-column-title">Suporte</h4>
                    <ul>
                        <li><a href="help_page_final.html" class="footer-link">Central de Ajuda</a></li>
                        <li><a href="help_page_final.html" class="footer-link">Tutoriais</a></li>
                        <li><a href="help_page_final.html" class="footer-link">Contato</a></li>
                        <li><a href="help_page_final.html" class="footer-link">Reportar Problema</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4 class="footer-column-title">Legal</h4>
                    <ul>
                        <li><a href="#" class="footer-link">Termos de Uso</a></li>
                        <li><a href="#" class="footer-link">Política de Privacidade</a></li>
                        <li><a href="https://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/l13709.htm" class="footer-link">LGPD</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Casa de Repouso Do Jeitinho da Vovó. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // função para animar a contagem de um valor
        function animateValue(obj, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.textContent = Math.floor(progress * (end - start) + start);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        document.addEventListener('DOMContentLoaded', () => {
            // função para buscar os dados (simulada por enquanto)
            async function fetchData(periodo) {
                // const response = await fetch(`/api/dashboard-data?periodo=${periodo}`);
                // const data = await response.json();
                // return data;

                // por enquanto retorna os dados estáticos
                return {
                    pacientes: 48,
                    novosPacientes: '+2 novos esta semana',
                    medicamentos: 342,
                    mudancaMedicamentos: '+12% que semana passada',
                    atividades: 15,
                    mudancaAtividades: '-3 a menos que semana passada',
                    ocupacaoMensal: [30, 40, 50, 47, 45, 49],
                    estoquePercentual: 75
                };
            }

            // função para renderizar o dashboard com os dados
            async function renderDashboard() {
                // obtém o período selecionado
                const periodoSelecionado = document.getElementById('periodSelect').value;
                const data = await fetchData(periodoSelecionado); // chama a função para obter os dados

                // atualiza os kpis com animação de contagem
                animateValue(document.getElementById('totalPacientes'), 0, data.pacientes, 1000); // 1 segundo de animação
                document.getElementById('novosPacientes').textContent = data.novosPacientes;

                animateValue(document.getElementById('medicamentos'), 0, data.medicamentos, 1000);
                document.getElementById('mudancaMedicamentos').textContent = data.mudancaMedicamentos;

                animateValue(document.getElementById('atividades'), 0, data.atividades, 1000);
                document.getElementById('mudancaAtividades').textContent = data.mudancaAtividades;

                // remove gráficos existentes antes de criar novos para evitar duplicação
                // e garantir que os dados corretos sejam exibidos
                const ocupacaoChartElement = document.getElementById('ocupacaoChart');
                const estoqueChartElement = document.getElementById('estoqueChart');

                // verifica se já existe uma instância do chart.js no canvas e a destrói
                if (ocupacaoChartElement.chart) {
                    ocupacaoChartElement.chart.destroy();
                }
                if (estoqueChartElement.chart) {
                    estoqueChartElement.chart.destroy();
                }

                // renderiza os gráficos
                ocupacaoChartElement.chart = new Chart(ocupacaoChartElement, {
                    type: 'bar',
                    data: {
                        labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                        datasets: [{
                            label: 'Ocupação',
                            data: data.ocupacaoMensal,
                            backgroundColor: '#2196f3'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });

                estoqueChartElement.chart = new Chart(estoqueChartElement, {
                    type: 'doughnut',
                    data: {
                        labels: ['OK', 'Baixo'],
                        datasets: [{
                            data: [data.estoquePercentual, 100 - data.estoquePercentual],
                            backgroundColor: ['#4caf50', '#f44336']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }

            // chama a função principal para iniciar o dashboard
            renderDashboard();

            // adiciona um ouvinte de evento para quando o período for alterado
            const periodSelect = document.getElementById('periodSelect');
            periodSelect.addEventListener('change', () => {
                renderDashboard(); // renderiza o dashboard novamente com o novo período
            });
        });
    </script>
</body>
</html>